# –§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ç—Ä–µ–∫–µ—Ä —Å—Ç—É–¥–µ–Ω—Ç–∞
# –ü—Ä–æ–≥—Ä–∞–º–∞ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç—É–¥–µ–Ω—Ç—É –≤–µ—Å—Ç–∏ –æ–±–ª—ñ–∫ –≤–∏—Ç—Ä–∞—Ç, –±—é–¥–∂–µ—Ç—É —Ç–∞ –±–∞—á–∏—Ç–∏ –∑–≤—ñ—Ç–∏.

import datetime

# –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –±—é–¥–∂–µ—Ç—É —Ç–∞ –≤–∏—Ç—Ä–∞—Ç
budget = 0.0
expenses = []

def welcome():
    """–í—ñ—Ç–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏."""
    print("üëã –ü—Ä–∏–≤—ñ—Ç! –Ø –±–æ—Ç '–§—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ç—Ä–µ–∫–µ—Ä —Å—Ç—É–¥–µ–Ω—Ç–∞'.")
    print("–í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É '–¥–æ–ø–æ–º–æ–≥–∞', —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏.")

def show_help():
    """–í–∏–≤–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–º–∞–Ω–¥."""
    print("\nüìå –î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:")
    print("  –¥–æ–ø–æ–º–æ–≥–∞              - —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥")
    print("  –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±—é–¥–∂–µ—Ç     - –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –º—ñ—Å—è—á–Ω–∏–π –±—é–¥–∂–µ—Ç")
    print("  –¥–æ–¥–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç—É        - –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—É –≤–∏—Ç—Ä–∞—Ç—É")
    print("  –ø–æ–∫–∞–∑–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏      - –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –≤–∏—Ç—Ä–∞—Ç–∏")
    print("  –∑–∞–ª–∏—à–æ–∫               - –ø–æ–∫–∞–∑–∞—Ç–∏ –∑–∞–ª–∏—à–æ–∫ –±—é–¥–∂–µ—Ç—É")
    print("  –∑–≤—ñ—Ç –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏   - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö")
    print("  –≤–∏–π—Ç–∏                 - –∑–∞–≤–µ—Ä—à–∏—Ç–∏ —Ä–æ–±–æ—Ç—É\n")

def set_budget():
    """–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç—É."""
    global budget
    try:
        budget = float(input("–í–≤–µ–¥–∏ —Å—É–º—É –±—é–¥–∂–µ—Ç—É (–≥—Ä–Ω): "))
        print(f"‚úÖ –ë—é–¥–∂–µ—Ç –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: {budget:.2f} –≥—Ä–Ω")
    except ValueError:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞: –≤–≤–µ–¥–µ–Ω–æ –Ω–µ—á–∏—Å–ª–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è.")

def add_expense():
    """–î–æ–¥–∞—î –Ω–æ–≤—É –≤–∏—Ç—Ä–∞—Ç—É –¥–æ —Å–ø–∏—Å–∫—É –≤–∏—Ç—Ä–∞—Ç."""
    try:
        amount = float(input("–°—É–º–∞ –≤–∏—Ç—Ä–∞—Ç–∏ (–≥—Ä–Ω): "))
        category = input("–ö–∞—Ç–µ–≥–æ—Ä—ñ—è –≤–∏—Ç—Ä–∞—Ç–∏ (—ó–∂–∞, —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç —Ç–æ—â–æ): ")
        date_str = input("–î–∞—Ç–∞ (–†–†–†–†-–ú–ú-–î–î), –∞–±–æ Enter –¥–ª—è —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—å–æ—ó: ")
        if date_str.strip() == "":
            date = datetime.date.today()
        else:
            date = datetime.datetime.strptime(date_str, "%Y-%m-%d").date()
        expenses.append({"amount": amount, "category": category, "date": date})
        print("‚úÖ –í–∏—Ç—Ä–∞—Ç—É –¥–æ–¥–∞–Ω–æ.")
    except ValueError:
        print("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ñ–æ—Ä–º–∞—Ç—É. –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑.")

def show_expenses():
    """–í–∏–≤–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –≤–∏—Ç—Ä–∞—Ç."""
    if not expenses:
        print("üì≠ –í–∏—Ç—Ä–∞—Ç –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î.")
    else:
        print("\nüìí –°–ø–∏—Å–æ–∫ –≤–∏—Ç—Ä–∞—Ç:")
        for i, e in enumerate(expenses, 1):
            print(f"{i}. {e['date']} | {e['category']} | {e['amount']:.2f} –≥—Ä–Ω")

def show_balance():
    """–û–±—á–∏—Å–ª—é—î —ñ –ø–æ–∫–∞–∑—É—î –∑–∞–ª–∏—à–æ–∫ –±—é–¥–∂–µ—Ç—É."""
    total_spent = sum(e["amount"] for e in expenses)
    remaining = budget - total_spent
    print(f"\nüí∞ –í—Å—å–æ–≥–æ –≤–∏—Ç—Ä–∞—á–µ–Ω–æ: {total_spent:.2f} –≥—Ä–Ω")
    print(f"üìâ –ó–∞–ª–∏—à–æ–∫ –±—é–¥–∂–µ—Ç—É: {remaining:.2f} –≥—Ä–Ω")

def category_report():
    """–§–æ—Ä–º—É—î –∑–≤—ñ—Ç –≤–∏—Ç—Ä–∞—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è—Ö."""
    if not expenses:
        print("üì≠ –í–∏—Ç—Ä–∞—Ç –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î.")
        return
    report = {}
    for e in expenses:
        report[e["category"]] = report.get(e["category"], 0) + e["amount"]
    print("\nüìä –í–∏—Ç—Ä–∞—Ç–∏ –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏:")
    for category, total in report.items():
        print(f"{category}: {total:.2f} –≥—Ä–Ω")

def main():
    """–ì–æ–ª–æ–≤–Ω–∏–π —Ü–∏–∫–ª –ø—Ä–æ–≥—Ä–∞–º–∏."""
    welcome()
    while True:
        command = input("\n–í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É: ").strip().lower()
        if command == "–¥–æ–ø–æ–º–æ–≥–∞":
            show_help()
        elif command == "–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –±—é–¥–∂–µ—Ç":
            set_budget()
        elif command == "–¥–æ–¥–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç—É":
            add_expense()
        elif command == "–ø–æ–∫–∞–∑–∞—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏":
            show_expenses()
        elif command == "–∑–∞–ª–∏—à–æ–∫":
            show_balance()
        elif command == "–∑–≤—ñ—Ç –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏":
            category_report()
        elif command == "–≤–∏–π—Ç–∏":
            print("üëã –î–æ –ø–æ–±–∞—á–µ–Ω–Ω—è!")
            break
        else:
            print("‚ùå –ù–µ–≤—ñ–¥–æ–º–∞ –∫–æ–º–∞–Ω–¥–∞. –í–≤–µ–¥–∏ '–¥–æ–ø–æ–º–æ–≥–∞'.")

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–∏
if name == "__main__":
    main()